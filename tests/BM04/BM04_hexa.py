# A SOLID CYLINDER UNDER PURE TENSION

def create_simulation (step, stop, outstep):
    Dir_out='out/tests/BM04_hexa_step_'+str(step)+'s'
    GEOMETRIC_EPSILON (1E-5)
  
    solfec=SOLFEC ('QUASI_STATIC', step, Dir_out)
    Nodes_M1=[
                    0.9437890E+00,-0.4293900E-01, 0.0000000E+00,
                    0.9245740E+00, 0.1521510E+00, 0.0000000E+00,
                    0.8676690E+00, 0.3397440E+00, 0.0000000E+00,
                    0.7752560E+00, 0.5126350E+00, 0.0000000E+00,
                    0.6508960E+00, 0.6641680E+00, 0.0000000E+00,
                    0.4993640E+00, 0.7885280E+00, 0.0000000E+00,
                    0.3264720E+00, 0.8809400E+00, 0.0000000E+00,
                    0.1388790E+00, 0.9378460E+00, 0.0000000E+00,
                   -0.5621100E-01, 0.9570610E+00, 0.0000000E+00,
                    0.6937890E+00,-0.4293900E-01, 0.0000000E+00,
                    0.6793780E+00, 0.1033790E+00, 0.0000000E+00,
                    0.6366990E+00, 0.2440730E+00, 0.0000000E+00,
                    0.5673890E+00, 0.3737420E+00, 0.0000000E+00,
                    0.4741190E+00, 0.4873910E+00, 0.0000000E+00,
                    0.3604700E+00, 0.5806610E+00, 0.0000000E+00,
                    0.2308020E+00, 0.6499710E+00, 0.0000000E+00,
                    0.9010700E-01, 0.6926500E+00, 0.0000000E+00,
                   -0.5621100E-01, 0.7070610E+00, 0.0000000E+00,
                    0.4437890E+00,-0.4293900E-01, 0.0000000E+00,
                    0.4341820E+00, 0.5460600E-01, 0.0000000E+00,
                    0.4057290E+00, 0.1484030E+00, 0.0000000E+00,
                    0.3595220E+00, 0.2348480E+00, 0.0000000E+00,
                    0.2973420E+00, 0.3106140E+00, 0.0000000E+00,
                    0.2215760E+00, 0.3727940E+00, 0.0000000E+00,
                    0.1351310E+00, 0.4190010E+00, 0.0000000E+00,
                    0.4133400E-01, 0.4474540E+00, 0.0000000E+00,
                   -0.5621100E-01, 0.4570610E+00, 0.0000000E+00,
                    0.1937890E+00,-0.4293900E-01, 0.0000000E+00,
                    0.1889850E+00, 0.5833000E-02, 0.0000000E+00,
                    0.1747590E+00, 0.5273200E-01, 0.0000000E+00,
                    0.1516560E+00, 0.9595500E-01, 0.0000000E+00,
                    0.1205660E+00, 0.1338380E+00, 0.0000000E+00,
                    0.8268300E-01, 0.1649280E+00, 0.0000000E+00,
                    0.3946000E-01, 0.1880310E+00, 0.0000000E+00,
                   -0.7438000E-02, 0.2022570E+00, 0.0000000E+00,
                   -0.5621100E-01, 0.2070610E+00, 0.0000000E+00,
                   -0.5621100E-01,-0.4293900E-01, 0.0000000E+00,
                    0.9437890E+00,-0.4293900E-01, 0.5000000E+00,
                    0.9245740E+00, 0.1521510E+00, 0.5000000E+00,
                    0.8676690E+00, 0.3397440E+00, 0.5000000E+00,
                    0.7752560E+00, 0.5126350E+00, 0.5000000E+00,
                    0.6508960E+00, 0.6641680E+00, 0.5000000E+00,
                    0.4993640E+00, 0.7885280E+00, 0.5000000E+00,
                    0.3264720E+00, 0.8809400E+00, 0.5000000E+00,
                    0.1388790E+00, 0.9378460E+00, 0.5000000E+00,
                   -0.5621100E-01, 0.9570610E+00, 0.5000000E+00,
                    0.6937890E+00,-0.4293900E-01, 0.5000000E+00,
                    0.6793780E+00, 0.1033790E+00, 0.5000000E+00,
                    0.6366990E+00, 0.2440730E+00, 0.5000000E+00,
                    0.5673890E+00, 0.3737420E+00, 0.5000000E+00,
                    0.4741190E+00, 0.4873910E+00, 0.5000000E+00,
                    0.3604700E+00, 0.5806610E+00, 0.5000000E+00,
                    0.2308020E+00, 0.6499710E+00, 0.5000000E+00,
                    0.9010700E-01, 0.6926500E+00, 0.5000000E+00,
                   -0.5621100E-01, 0.7070610E+00, 0.5000000E+00,
                    0.4437890E+00,-0.4293900E-01, 0.5000000E+00,
                    0.4341820E+00, 0.5460600E-01, 0.5000000E+00,
                    0.4057290E+00, 0.1484030E+00, 0.5000000E+00,
                    0.3595220E+00, 0.2348480E+00, 0.5000000E+00,
                    0.2973420E+00, 0.3106140E+00, 0.5000000E+00,
                    0.2215760E+00, 0.3727940E+00, 0.5000000E+00,
                    0.1351310E+00, 0.4190010E+00, 0.5000000E+00,
                    0.4133400E-01, 0.4474540E+00, 0.5000000E+00,
                   -0.5621100E-01, 0.4570610E+00, 0.5000000E+00,
                    0.1937890E+00,-0.4293900E-01, 0.5000000E+00,
                    0.1889850E+00, 0.5833000E-02, 0.5000000E+00,
                    0.1747590E+00, 0.5273200E-01, 0.5000000E+00,
                    0.1516560E+00, 0.9595500E-01, 0.5000000E+00,
                    0.1205660E+00, 0.1338380E+00, 0.5000000E+00,
                    0.8268300E-01, 0.1649280E+00, 0.5000000E+00,
                    0.3946000E-01, 0.1880310E+00, 0.5000000E+00,
                   -0.7438000E-02, 0.2022570E+00, 0.5000000E+00,
                   -0.5621100E-01, 0.2070610E+00, 0.5000000E+00,
                   -0.5621100E-01,-0.4293900E-01, 0.5000000E+00,
                    0.9437890E+00,-0.4293900E-01, 0.1000000E+01,
                    0.9245740E+00, 0.1521510E+00, 0.1000000E+01,
                    0.8676690E+00, 0.3397440E+00, 0.1000000E+01,
                    0.7752560E+00, 0.5126350E+00, 0.1000000E+01,
                    0.6508960E+00, 0.6641680E+00, 0.1000000E+01,
                    0.4993640E+00, 0.7885280E+00, 0.1000000E+01,
                    0.3264720E+00, 0.8809400E+00, 0.1000000E+01,
                    0.1388790E+00, 0.9378460E+00, 0.1000000E+01,
                   -0.5621100E-01, 0.9570610E+00, 0.1000000E+01,
                    0.6937890E+00,-0.4293900E-01, 0.1000000E+01,
                    0.6793780E+00, 0.1033790E+00, 0.1000000E+01,
                    0.6366990E+00, 0.2440730E+00, 0.1000000E+01,
                    0.5673890E+00, 0.3737420E+00, 0.1000000E+01,
                    0.4741190E+00, 0.4873910E+00, 0.1000000E+01,
                    0.3604700E+00, 0.5806610E+00, 0.1000000E+01,
                    0.2308020E+00, 0.6499710E+00, 0.1000000E+01,
                    0.9010700E-01, 0.6926500E+00, 0.1000000E+01,
                   -0.5621100E-01, 0.7070610E+00, 0.1000000E+01,
                    0.4437890E+00,-0.4293900E-01, 0.1000000E+01,
                    0.4341820E+00, 0.5460600E-01, 0.1000000E+01,
                    0.4057290E+00, 0.1484030E+00, 0.1000000E+01,
                    0.3595220E+00, 0.2348480E+00, 0.1000000E+01,
                    0.2973420E+00, 0.3106140E+00, 0.1000000E+01,
                    0.2215760E+00, 0.3727940E+00, 0.1000000E+01,
                    0.1351310E+00, 0.4190010E+00, 0.1000000E+01,
                    0.4133400E-01, 0.4474540E+00, 0.1000000E+01,
                   -0.5621100E-01, 0.4570610E+00, 0.1000000E+01,
                    0.1937890E+00,-0.4293900E-01, 0.1000000E+01,
                    0.1889850E+00, 0.5833000E-02, 0.1000000E+01,
                    0.1747590E+00, 0.5273200E-01, 0.1000000E+01,
                    0.1516560E+00, 0.9595500E-01, 0.1000000E+01,
                    0.1205660E+00, 0.1338380E+00, 0.1000000E+01,
                    0.8268300E-01, 0.1649280E+00, 0.1000000E+01,
                    0.3946000E-01, 0.1880310E+00, 0.1000000E+01,
                   -0.7438000E-02, 0.2022570E+00, 0.1000000E+01,
                   -0.5621100E-01, 0.2070610E+00, 0.1000000E+01,
                   -0.5621100E-01,-0.4293900E-01, 0.1000000E+01,
                    0.9437890E+00,-0.4293900E-01, 0.1500000E+01,
                    0.9245740E+00, 0.1521510E+00, 0.1500000E+01,
                    0.8676690E+00, 0.3397440E+00, 0.1500000E+01,
                    0.7752560E+00, 0.5126350E+00, 0.1500000E+01,
                    0.6508960E+00, 0.6641680E+00, 0.1500000E+01,
                    0.4993640E+00, 0.7885280E+00, 0.1500000E+01,
                    0.3264720E+00, 0.8809400E+00, 0.1500000E+01,
                    0.1388790E+00, 0.9378460E+00, 0.1500000E+01,
                   -0.5621100E-01, 0.9570610E+00, 0.1500000E+01,
                    0.6937890E+00,-0.4293900E-01, 0.1500000E+01,
                    0.6793780E+00, 0.1033790E+00, 0.1500000E+01,
                    0.6366990E+00, 0.2440730E+00, 0.1500000E+01,
                    0.5673890E+00, 0.3737420E+00, 0.1500000E+01,
                    0.4741190E+00, 0.4873910E+00, 0.1500000E+01,
                    0.3604700E+00, 0.5806610E+00, 0.1500000E+01,
                    0.2308020E+00, 0.6499710E+00, 0.1500000E+01,
                    0.9010700E-01, 0.6926500E+00, 0.1500000E+01,
                   -0.5621100E-01, 0.7070610E+00, 0.1500000E+01,
                    0.4437890E+00,-0.4293900E-01, 0.1500000E+01,
                    0.4341820E+00, 0.5460600E-01, 0.1500000E+01,
                    0.4057290E+00, 0.1484030E+00, 0.1500000E+01,
                    0.3595220E+00, 0.2348480E+00, 0.1500000E+01,
                    0.2973420E+00, 0.3106140E+00, 0.1500000E+01,
                    0.2215760E+00, 0.3727940E+00, 0.1500000E+01,
                    0.1351310E+00, 0.4190010E+00, 0.1500000E+01,
                    0.4133400E-01, 0.4474540E+00, 0.1500000E+01,
                   -0.5621100E-01, 0.4570610E+00, 0.1500000E+01,
                    0.1937890E+00,-0.4293900E-01, 0.1500000E+01,
                    0.1889850E+00, 0.5833000E-02, 0.1500000E+01,
                    0.1747590E+00, 0.5273200E-01, 0.1500000E+01,
                    0.1516560E+00, 0.9595500E-01, 0.1500000E+01,
                    0.1205660E+00, 0.1338380E+00, 0.1500000E+01,
                    0.8268300E-01, 0.1649280E+00, 0.1500000E+01,
                    0.3946000E-01, 0.1880310E+00, 0.1500000E+01,
                   -0.7438000E-02, 0.2022570E+00, 0.1500000E+01,
                   -0.5621100E-01, 0.2070610E+00, 0.1500000E+01,
                   -0.5621100E-01,-0.4293900E-01, 0.1500000E+01,
                    0.9437890E+00,-0.4293900E-01, 0.2000000E+01,
                    0.9245740E+00, 0.1521510E+00, 0.2000000E+01,
                    0.8676690E+00, 0.3397440E+00, 0.2000000E+01,
                    0.7752560E+00, 0.5126350E+00, 0.2000000E+01,
                    0.6508960E+00, 0.6641680E+00, 0.2000000E+01,
                    0.4993640E+00, 0.7885280E+00, 0.2000000E+01,
                    0.3264720E+00, 0.8809400E+00, 0.2000000E+01,
                    0.1388790E+00, 0.9378460E+00, 0.2000000E+01,
                   -0.5621100E-01, 0.9570610E+00, 0.2000000E+01,
                    0.6937890E+00,-0.4293900E-01, 0.2000000E+01,
                    0.6793780E+00, 0.1033790E+00, 0.2000000E+01,
                    0.6366990E+00, 0.2440730E+00, 0.2000000E+01,
                    0.5673890E+00, 0.3737420E+00, 0.2000000E+01,
                    0.4741190E+00, 0.4873910E+00, 0.2000000E+01,
                    0.3604700E+00, 0.5806610E+00, 0.2000000E+01,
                    0.2308020E+00, 0.6499710E+00, 0.2000000E+01,
                    0.9010700E-01, 0.6926500E+00, 0.2000000E+01,
                   -0.5621100E-01, 0.7070610E+00, 0.2000000E+01,
                    0.4437890E+00,-0.4293900E-01, 0.2000000E+01,
                    0.4341820E+00, 0.5460600E-01, 0.2000000E+01,
                    0.4057290E+00, 0.1484030E+00, 0.2000000E+01,
                    0.3595220E+00, 0.2348480E+00, 0.2000000E+01,
                    0.2973420E+00, 0.3106140E+00, 0.2000000E+01,
                    0.2215760E+00, 0.3727940E+00, 0.2000000E+01,
                    0.1351310E+00, 0.4190010E+00, 0.2000000E+01,
                    0.4133400E-01, 0.4474540E+00, 0.2000000E+01,
                   -0.5621100E-01, 0.4570610E+00, 0.2000000E+01,
                    0.1937890E+00,-0.4293900E-01, 0.2000000E+01,
                    0.1889850E+00, 0.5833000E-02, 0.2000000E+01,
                    0.1747590E+00, 0.5273200E-01, 0.2000000E+01,
                    0.1516560E+00, 0.9595500E-01, 0.2000000E+01,
                    0.1205660E+00, 0.1338380E+00, 0.2000000E+01,
                    0.8268300E-01, 0.1649280E+00, 0.2000000E+01,
                    0.3946000E-01, 0.1880310E+00, 0.2000000E+01,
                   -0.7438000E-02, 0.2022570E+00, 0.2000000E+01,
                   -0.5621100E-01, 0.2070610E+00, 0.2000000E+01,
                   -0.5621100E-01,-0.4293900E-01, 0.2000000E+01,
                    0.9437890E+00,-0.4293900E-01, 0.2500000E+01,
                    0.9245740E+00, 0.1521510E+00, 0.2500000E+01,
                    0.8676690E+00, 0.3397440E+00, 0.2500000E+01,
                    0.7752560E+00, 0.5126350E+00, 0.2500000E+01,
                    0.6508960E+00, 0.6641680E+00, 0.2500000E+01,
                    0.4993640E+00, 0.7885280E+00, 0.2500000E+01,
                    0.3264720E+00, 0.8809400E+00, 0.2500000E+01,
                    0.1388790E+00, 0.9378460E+00, 0.2500000E+01,
                   -0.5621100E-01, 0.9570610E+00, 0.2500000E+01,
                    0.6937890E+00,-0.4293900E-01, 0.2500000E+01,
                    0.6793780E+00, 0.1033790E+00, 0.2500000E+01,
                    0.6366990E+00, 0.2440730E+00, 0.2500000E+01,
                    0.5673890E+00, 0.3737420E+00, 0.2500000E+01,
                    0.4741190E+00, 0.4873910E+00, 0.2500000E+01,
                    0.3604700E+00, 0.5806610E+00, 0.2500000E+01,
                    0.2308020E+00, 0.6499710E+00, 0.2500000E+01,
                    0.9010700E-01, 0.6926500E+00, 0.2500000E+01,
                   -0.5621100E-01, 0.7070610E+00, 0.2500000E+01,
                    0.4437890E+00,-0.4293900E-01, 0.2500000E+01,
                    0.4341820E+00, 0.5460600E-01, 0.2500000E+01,
                    0.4057290E+00, 0.1484030E+00, 0.2500000E+01,
                    0.3595220E+00, 0.2348480E+00, 0.2500000E+01,
                    0.2973420E+00, 0.3106140E+00, 0.2500000E+01,
                    0.2215760E+00, 0.3727940E+00, 0.2500000E+01,
                    0.1351310E+00, 0.4190010E+00, 0.2500000E+01,
                    0.4133400E-01, 0.4474540E+00, 0.2500000E+01,
                   -0.5621100E-01, 0.4570610E+00, 0.2500000E+01,
                    0.1937890E+00,-0.4293900E-01, 0.2500000E+01,
                    0.1889850E+00, 0.5833000E-02, 0.2500000E+01,
                    0.1747590E+00, 0.5273200E-01, 0.2500000E+01,
                    0.1516560E+00, 0.9595500E-01, 0.2500000E+01,
                    0.1205660E+00, 0.1338380E+00, 0.2500000E+01,
                    0.8268300E-01, 0.1649280E+00, 0.2500000E+01,
                    0.3946000E-01, 0.1880310E+00, 0.2500000E+01,
                   -0.7438000E-02, 0.2022570E+00, 0.2500000E+01,
                   -0.5621100E-01, 0.2070610E+00, 0.2500000E+01,
                   -0.5621100E-01,-0.4293900E-01, 0.2500000E+01,
                    0.9437890E+00,-0.4293900E-01, 0.3000000E+01,
                    0.9245740E+00, 0.1521510E+00, 0.3000000E+01,
                    0.8676690E+00, 0.3397440E+00, 0.3000000E+01,
                    0.7752560E+00, 0.5126350E+00, 0.3000000E+01,
                    0.6508960E+00, 0.6641680E+00, 0.3000000E+01,
                    0.4993640E+00, 0.7885280E+00, 0.3000000E+01,
                    0.3264720E+00, 0.8809400E+00, 0.3000000E+01,
                    0.1388790E+00, 0.9378460E+00, 0.3000000E+01,
                   -0.5621100E-01, 0.9570610E+00, 0.3000000E+01,
                    0.6937890E+00,-0.4293900E-01, 0.3000000E+01,
                    0.6793780E+00, 0.1033790E+00, 0.3000000E+01,
                    0.6366990E+00, 0.2440730E+00, 0.3000000E+01,
                    0.5673890E+00, 0.3737420E+00, 0.3000000E+01,
                    0.4741190E+00, 0.4873910E+00, 0.3000000E+01,
                    0.3604700E+00, 0.5806610E+00, 0.3000000E+01,
                    0.2308020E+00, 0.6499710E+00, 0.3000000E+01,
                    0.9010700E-01, 0.6926500E+00, 0.3000000E+01,
                   -0.5621100E-01, 0.7070610E+00, 0.3000000E+01,
                    0.4437890E+00,-0.4293900E-01, 0.3000000E+01,
                    0.4341820E+00, 0.5460600E-01, 0.3000000E+01,
                    0.4057290E+00, 0.1484030E+00, 0.3000000E+01,
                    0.3595220E+00, 0.2348480E+00, 0.3000000E+01,
                    0.2973420E+00, 0.3106140E+00, 0.3000000E+01,
                    0.2215760E+00, 0.3727940E+00, 0.3000000E+01,
                    0.1351310E+00, 0.4190010E+00, 0.3000000E+01,
                    0.4133400E-01, 0.4474540E+00, 0.3000000E+01,
                   -0.5621100E-01, 0.4570610E+00, 0.3000000E+01,
                    0.1937890E+00,-0.4293900E-01, 0.3000000E+01,
                    0.1889850E+00, 0.5833000E-02, 0.3000000E+01,
                    0.1747590E+00, 0.5273200E-01, 0.3000000E+01,
                    0.1516560E+00, 0.9595500E-01, 0.3000000E+01,
                    0.1205660E+00, 0.1338380E+00, 0.3000000E+01,
                    0.8268300E-01, 0.1649280E+00, 0.3000000E+01,
                    0.3946000E-01, 0.1880310E+00, 0.3000000E+01,
                   -0.7438000E-02, 0.2022570E+00, 0.3000000E+01,
                   -0.5621100E-01, 0.2070610E+00, 0.3000000E+01,
                   -0.5621100E-01,-0.4293900E-01, 0.3000000E+01,]
                   
              
    
    #ELEM_TETRA8
    ############
    M25      = [6,     27,     28,     36,     64,     65,     73,      1]
    M26      = [6,     28,     29,     36,     65,     66,     73,      2]
    M27      = [6,     29,     30,     36,     66,     67,     73,      3]
    M28      = [6,     30,     31,     36,     67,     68,     73,      4]
    M29      = [6,     31,     32,     36,     68,     69,     73,      5]
    M30      = [6,     32,     33,     36,     69,     70,     73,      6]
    M31      = [6,     33,     34,     36,     70,     71,     73,      7]
    M32      = [6,     34,     35,     36,     71,     72,     73,      8]
    M57      = [6,     64,     65,     73,    101,    102,    110,      9]
    M58      = [6,     65,     66,     73,    102,    103,    110,     10]
    M59      = [6,     66,     67,     73,    103,    104,    110,     11]
    M60      = [6,     67,     68,     73,    104,    105,    110,     12]
    M61      = [6,     68,     69,     73,    105,    106,    110,     13]
    M62      = [6,     69,     70,     73,    106,    107,    110,     14]
    M63      = [6,     70,     71,     73,    107,    108,    110,     15]
    M64      = [6,     71,     72,     73,    108,    109,    110,     16]
    M89      = [6,    101,    102,    110,    138,    139,    147,     17]
    M90      = [6,    102,    103,    110,    139,    140,    147,     18]
    M91      = [6,    103,    104,    110,    140,    141,    147,     19]
    M92      = [6,    104,    105,    110,    141,    142,    147,     20]
    M93      = [6,    105,    106,    110,    142,    143,    147,     21]
    M94      = [6,    106,    107,    110,    143,    144,    147,     22]
    M95      = [6,    107,    108,    110,    144,    145,    147,     23]
    M96      = [6,    108,    109,    110,    145,    146,    147,     24]
    M121     = [6,    138,    139,    147,    175,    176,    184,     25]
    M122     = [6,    139,    140,    147,    176,    177,    184,     26]
    M123     = [6,    140,    141,    147,    177,    178,    184,     27]
    M124     = [6,    141,    142,    147,    178,    179,    184,     28]
    M125     = [6,    142,    143,    147,    179,    180,    184,     29]
    M126     = [6,    143,    144,    147,    180,    181,    184,     30]
    M127     = [6,    144,    145,    147,    181,    182,    184,     31]
    M128     = [6,    145,    146,    147,    182,    183,    184,     32]
    M153     = [6,    175,    176,    184,    212,    213,    221,     33]
    M154     = [6,    176,    177,    184,    213,    214,    221,     34]
    M155     = [6,    177,    178,    184,    214,    215,    221,     35]
    M156     = [6,    178,    179,    184,    215,    216,    221,     36]
    M157     = [6,    179,    180,    184,    216,    217,    221,     37]
    M158     = [6,    180,    181,    184,    217,    218,    221,     38]
    M159     = [6,    181,    182,    184,    218,    219,    221,     39]
    M160     = [6,    182,    183,    184,    219,    220,    221,     40]
    M185     = [6,    212,    213,    221,    249,    250,    258,     41]
    M186     = [6,    213,    214,    221,    250,    251,    258,     42]
    M187     = [6,    214,    215,    221,    251,    252,    258,     43]
    M188     = [6,    215,    216,    221,    252,    253,    258,     44]
    M189     = [6,    216,    217,    221,    253,    254,    258,     45]
    M190     = [6,    217,    218,    221,    254,    255,    258,     46]
    M191     = [6,    218,    219,    221,    255,    256,    258,     47]
    M192     = [6,    219,    220,    221,    256,    257,    258,     48]
    #ELEM_TETRA8
    ############
    M1       = [8,      0,      1,     10,      9,     37,     38,     47,     46,      1]
    M2       = [8,      1,      2,     11,     10,     38,     39,     48,     47,      2]
    M3       = [8,      2,      3,     12,     11,     39,     40,     49,     48,      3]
    M4       = [8,      3,      4,     13,     12,     40,     41,     50,     49,      4]
    M5       = [8,      4,      5,     14,     13,     41,     42,     51,     50,      5]
    M6       = [8,      5,      6,     15,     14,     42,     43,     52,     51,      6]
    M7       = [8,      6,      7,     16,     15,     43,     44,     53,     52,      7]
    M8       = [8,      7,      8,     17,     16,     44,     45,     54,     53,      8]
    M9       = [8,      9,     10,     19,     18,     46,     47,     56,     55,      9]
    M10      = [8,     10,     11,     20,     19,     47,     48,     57,     56,     10]
    M11      = [8,     11,     12,     21,     20,     48,     49,     58,     57,     11]
    M12      = [8,     12,     13,     22,     21,     49,     50,     59,     58,     12]
    M13      = [8,     13,     14,     23,     22,     50,     51,     60,     59,     13]
    M14      = [8,     14,     15,     24,     23,     51,     52,     61,     60,     14]
    M15      = [8,     15,     16,     25,     24,     52,     53,     62,     61,     15]
    M16      = [8,     16,     17,     26,     25,     53,     54,     63,     62,     16]
    M17      = [8,     18,     19,     28,     27,     55,     56,     65,     64,     17]
    M18      = [8,     19,     20,     29,     28,     56,     57,     66,     65,     18]
    M19      = [8,     20,     21,     30,     29,     57,     58,     67,     66,     19]
    M20      = [8,     21,     22,     31,     30,     58,     59,     68,     67,     20]
    M21      = [8,     22,     23,     32,     31,     59,     60,     69,     68,     21]
    M22      = [8,     23,     24,     33,     32,     60,     61,     70,     69,     22]
    M23      = [8,     24,     25,     34,     33,     61,     62,     71,     70,     23]
    M24      = [8,     25,     26,     35,     34,     62,     63,     72,     71,     24]
    M33      = [8,     37,     38,     47,     46,     74,     75,     84,     83,     25]
    M34      = [8,     38,     39,     48,     47,     75,     76,     85,     84,     26]
    M35      = [8,     39,     40,     49,     48,     76,     77,     86,     85,     27]
    M36      = [8,     40,     41,     50,     49,     77,     78,     87,     86,     28]
    M37      = [8,     41,     42,     51,     50,     78,     79,     88,     87,     29]
    M38      = [8,     42,     43,     52,     51,     79,     80,     89,     88,     30]
    M39      = [8,     43,     44,     53,     52,     80,     81,     90,     89,     31]
    M40      = [8,     44,     45,     54,     53,     81,     82,     91,     90,     32]
    M41      = [8,     46,     47,     56,     55,     83,     84,     93,     92,     33]
    M42      = [8,     47,     48,     57,     56,     84,     85,     94,     93,     34]
    M43      = [8,     48,     49,     58,     57,     85,     86,     95,     94,     35]
    M44      = [8,     49,     50,     59,     58,     86,     87,     96,     95,     36]
    M45      = [8,     50,     51,     60,     59,     87,     88,     97,     96,     37]
    M46      = [8,     51,     52,     61,     60,     88,     89,     98,     97,     38]
    M47      = [8,     52,     53,     62,     61,     89,     90,     99,     98,     39]
    M48      = [8,     53,     54,     63,     62,     90,     91,    100,     99,     40]
    M49      = [8,     55,     56,     65,     64,     92,     93,    102,    101,     41]
    M50      = [8,     56,     57,     66,     65,     93,     94,    103,    102,     42]
    M51      = [8,     57,     58,     67,     66,     94,     95,    104,    103,     43]
    M52      = [8,     58,     59,     68,     67,     95,     96,    105,    104,     44]
    M53      = [8,     59,     60,     69,     68,     96,     97,    106,    105,     45]
    M54      = [8,     60,     61,     70,     69,     97,     98,    107,    106,     46]
    M55      = [8,     61,     62,     71,     70,     98,     99,    108,    107,     47]
    M56      = [8,     62,     63,     72,     71,     99,    100,    109,    108,     48]
    M65      = [8,     74,     75,     84,     83,    111,    112,    121,    120,     49]
    M66      = [8,     75,     76,     85,     84,    112,    113,    122,    121,     50]
    M67      = [8,     76,     77,     86,     85,    113,    114,    123,    122,     51]
    M68      = [8,     77,     78,     87,     86,    114,    115,    124,    123,     52]
    M69      = [8,     78,     79,     88,     87,    115,    116,    125,    124,     53]
    M70      = [8,     79,     80,     89,     88,    116,    117,    126,    125,     54]
    M71      = [8,     80,     81,     90,     89,    117,    118,    127,    126,     55]
    M72      = [8,     81,     82,     91,     90,    118,    119,    128,    127,     56]
    M73      = [8,     83,     84,     93,     92,    120,    121,    130,    129,     57]
    M74      = [8,     84,     85,     94,     93,    121,    122,    131,    130,     58]
    M75      = [8,     85,     86,     95,     94,    122,    123,    132,    131,     59]
    M76      = [8,     86,     87,     96,     95,    123,    124,    133,    132,     60]
    M77      = [8,     87,     88,     97,     96,    124,    125,    134,    133,     61]
    M78      = [8,     88,     89,     98,     97,    125,    126,    135,    134,     62]
    M79      = [8,     89,     90,     99,     98,    126,    127,    136,    135,     63]
    M80      = [8,     90,     91,    100,     99,    127,    128,    137,    136,     64]
    M81      = [8,     92,     93,    102,    101,    129,    130,    139,    138,     65]
    M82      = [8,     93,     94,    103,    102,    130,    131,    140,    139,     66]
    M83      = [8,     94,     95,    104,    103,    131,    132,    141,    140,     67]
    M84      = [8,     95,     96,    105,    104,    132,    133,    142,    141,     68]
    M85      = [8,     96,     97,    106,    105,    133,    134,    143,    142,     69]
    M86      = [8,     97,     98,    107,    106,    134,    135,    144,    143,     70]
    M87      = [8,     98,     99,    108,    107,    135,    136,    145,    144,     71]
    M88      = [8,     99,    100,    109,    108,    136,    137,    146,    145,     72]
    M97      = [8,    111,    112,    121,    120,    148,    149,    158,    157,     73]
    M98      = [8,    112,    113,    122,    121,    149,    150,    159,    158,     74]
    M99      = [8,    113,    114,    123,    122,    150,    151,    160,    159,     75]
    M100     = [8,    114,    115,    124,    123,    151,    152,    161,    160,     76]
    M101     = [8,    115,    116,    125,    124,    152,    153,    162,    161,     77]
    M102     = [8,    116,    117,    126,    125,    153,    154,    163,    162,     78]
    M103     = [8,    117,    118,    127,    126,    154,    155,    164,    163,     79]
    M104     = [8,    118,    119,    128,    127,    155,    156,    165,    164,     80]
    M105     = [8,    120,    121,    130,    129,    157,    158,    167,    166,     81]
    M106     = [8,    121,    122,    131,    130,    158,    159,    168,    167,     82]
    M107     = [8,    122,    123,    132,    131,    159,    160,    169,    168,     83]
    M108     = [8,    123,    124,    133,    132,    160,    161,    170,    169,     84]
    M109     = [8,    124,    125,    134,    133,    161,    162,    171,    170,     85]
    M110     = [8,    125,    126,    135,    134,    162,    163,    172,    171,     86]
    M111     = [8,    126,    127,    136,    135,    163,    164,    173,    172,     87]
    M112     = [8,    127,    128,    137,    136,    164,    165,    174,    173,     88]
    M113     = [8,    129,    130,    139,    138,    166,    167,    176,    175,     89]
    M114     = [8,    130,    131,    140,    139,    167,    168,    177,    176,     90]
    M115     = [8,    131,    132,    141,    140,    168,    169,    178,    177,     91]
    M116     = [8,    132,    133,    142,    141,    169,    170,    179,    178,     92]
    M117     = [8,    133,    134,    143,    142,    170,    171,    180,    179,     93]
    M118     = [8,    134,    135,    144,    143,    171,    172,    181,    180,     94]
    M119     = [8,    135,    136,    145,    144,    172,    173,    182,    181,     95]
    M120     = [8,    136,    137,    146,    145,    173,    174,    183,    182,     96]
    M129     = [8,    148,    149,    158,    157,    185,    186,    195,    194,     97]
    M130     = [8,    149,    150,    159,    158,    186,    187,    196,    195,     98]
    M131     = [8,    150,    151,    160,    159,    187,    188,    197,    196,     99]
    M132     = [8,    151,    152,    161,    160,    188,    189,    198,    197,    100]
    M133     = [8,    152,    153,    162,    161,    189,    190,    199,    198,    101]
    M134     = [8,    153,    154,    163,    162,    190,    191,    200,    199,    102]
    M135     = [8,    154,    155,    164,    163,    191,    192,    201,    200,    103]
    M136     = [8,    155,    156,    165,    164,    192,    193,    202,    201,    104]
    M137     = [8,    157,    158,    167,    166,    194,    195,    204,    203,    105]
    M138     = [8,    158,    159,    168,    167,    195,    196,    205,    204,    106]
    M139     = [8,    159,    160,    169,    168,    196,    197,    206,    205,    107]
    M140     = [8,    160,    161,    170,    169,    197,    198,    207,    206,    108]
    M141     = [8,    161,    162,    171,    170,    198,    199,    208,    207,    109]
    M142     = [8,    162,    163,    172,    171,    199,    200,    209,    208,    110]
    M143     = [8,    163,    164,    173,    172,    200,    201,    210,    209,    111]
    M144     = [8,    164,    165,    174,    173,    201,    202,    211,    210,    112]
    M145     = [8,    166,    167,    176,    175,    203,    204,    213,    212,    113]
    M146     = [8,    167,    168,    177,    176,    204,    205,    214,    213,    114]
    M147     = [8,    168,    169,    178,    177,    205,    206,    215,    214,    115]
    M148     = [8,    169,    170,    179,    178,    206,    207,    216,    215,    116]
    M149     = [8,    170,    171,    180,    179,    207,    208,    217,    216,    117]
    M150     = [8,    171,    172,    181,    180,    208,    209,    218,    217,    118]
    M151     = [8,    172,    173,    182,    181,    209,    210,    219,    218,    119]
    M152     = [8,    173,    174,    183,    182,    210,    211,    220,    219,    120]
    M161     = [8,    185,    186,    195,    194,    222,    223,    232,    231,    121]
    M162     = [8,    186,    187,    196,    195,    223,    224,    233,    232,    122]
    M163     = [8,    187,    188,    197,    196,    224,    225,    234,    233,    123]
    M164     = [8,    188,    189,    198,    197,    225,    226,    235,    234,    124]
    M165     = [8,    189,    190,    199,    198,    226,    227,    236,    235,    125]
    M166     = [8,    190,    191,    200,    199,    227,    228,    237,    236,    126]
    M167     = [8,    191,    192,    201,    200,    228,    229,    238,    237,    127]
    M168     = [8,    192,    193,    202,    201,    229,    230,    239,    238,    128]
    M169     = [8,    194,    195,    204,    203,    231,    232,    241,    240,    129]
    M170     = [8,    195,    196,    205,    204,    232,    233,    242,    241,    130]
    M171     = [8,    196,    197,    206,    205,    233,    234,    243,    242,    131]
    M172     = [8,    197,    198,    207,    206,    234,    235,    244,    243,    132]
    M173     = [8,    198,    199,    208,    207,    235,    236,    245,    244,    133]
    M174     = [8,    199,    200,    209,    208,    236,    237,    246,    245,    134]
    M175     = [8,    200,    201,    210,    209,    237,    238,    247,    246,    135]
    M176     = [8,    201,    202,    211,    210,    238,    239,    248,    247,    136]
    M177     = [8,    203,    204,    213,    212,    240,    241,    250,    249,    137]
    M178     = [8,    204,    205,    214,    213,    241,    242,    251,    250,    138]
    M179     = [8,    205,    206,    215,    214,    242,    243,    252,    251,    139]
    M180     = [8,    206,    207,    216,    215,    243,    244,    253,    252,    140]
    M181     = [8,    207,    208,    217,    216,    244,    245,    254,    253,    141]
    M182     = [8,    208,    209,    218,    217,    245,    246,    255,    254,    142]
    M183     = [8,    209,    210,    219,    218,    246,    247,    256,    255,    143]
    M184     = [8,    210,    211,    220,    219,    247,    248,    257,    256,    144]

    Mesh_M1 = M25      + \
            M26      + \
            M27      + \
            M28      + \
            M29      + \
            M30      + \
            M31      + \
            M32      + \
            M57      + \
            M58      + \
            M59      + \
            M60      + \
            M61      + \
            M62      + \
            M63      + \
            M64      + \
            M89      + \
            M90      + \
            M91      + \
            M92      + \
            M93      + \
            M94      + \
            M95      + \
            M96      + \
            M121     + \
            M122     + \
            M123     + \
            M124     + \
            M125     + \
            M126     + \
            M127     + \
            M128     + \
            M153     + \
            M154     + \
            M155     + \
            M156     + \
            M157     + \
            M158     + \
            M159     + \
            M160     + \
            M185     + \
            M186     + \
            M187     + \
            M188     + \
            M189     + \
            M190     + \
            M191     + \
            M192     + \
            M1       + \
            M2       + \
            M3       + \
            M4       + \
            M5       + \
            M6       + \
            M7       + \
            M8       + \
            M9       + \
            M10      + \
            M11      + \
            M12      + \
            M13      + \
            M14      + \
            M15      + \
            M16      + \
            M17      + \
            M18      + \
            M19      + \
            M20      + \
            M21      + \
            M22      + \
            M23      + \
            M24      + \
            M33      + \
            M34      + \
            M35      + \
            M36      + \
            M37      + \
            M38      + \
            M39      + \
            M40      + \
            M41      + \
            M42      + \
            M43      + \
            M44      + \
            M45      + \
            M46      + \
            M47      + \
            M48      + \
            M49      + \
            M50      + \
            M51      + \
            M52      + \
            M53      + \
            M54      + \
            M55      + \
            M56      + \
            M65      + \
            M66      + \
            M67      + \
            M68      + \
            M69      + \
            M70      + \
            M71      + \
            M72      + \
            M73      + \
            M74      + \
            M75      + \
            M76      + \
            M77      + \
            M78      + \
            M79      + \
            M80      + \
            M81      + \
            M82      + \
            M83      + \
            M84      + \
            M85      + \
            M86      + \
            M87      + \
            M88      + \
            M97      + \
            M98      + \
            M99      + \
            M100     + \
            M101     + \
            M102     + \
            M103     + \
            M104     + \
            M105     + \
            M106     + \
            M107     + \
            M108     + \
            M109     + \
            M110     + \
            M111     + \
            M112     + \
            M113     + \
            M114     + \
            M115     + \
            M116     + \
            M117     + \
            M118     + \
            M119     + \
            M120     + \
            M129     + \
            M130     + \
            M131     + \
            M132     + \
            M133     + \
            M134     + \
            M135     + \
            M136     + \
            M137     + \
            M138     + \
            M139     + \
            M140     + \
            M141     + \
            M142     + \
            M143     + \
            M144     + \
            M145     + \
            M146     + \
            M147     + \
            M148     + \
            M149     + \
            M150     + \
            M151     + \
            M152     + \
            M161     + \
            M162     + \
            M163     + \
            M164     + \
            M165     + \
            M166     + \
            M167     + \
            M168     + \
            M169     + \
            M170     + \
            M171     + \
            M172     + \
            M173     + \
            M174     + \
            M175     + \
            M176     + \
            M177     + \
            M178     + \
            M179     + \
            M180     + \
            M181     + \
            M182     + \
            M183     + \
            M184
           
    M193=[ 24,     3,   257,   258,   256,  11]
    M194=[         3,   256,   258,   255,  11]
    M195=[         3,   255,   258,   254,  11]               
    M196=[         3,   254,   258,   253,  11]
    M197=[         3,   253,   258,   252,  11]
    M198=[         3,   252,   258,   251,  11]
    M199=[         3,   251,   258,   250,  11]
    M200=[         3,   250,   258,   249,  11]
    M201=[         4,   248,   257,   256,   247,  11]
    M202=[         4,   247,   256,   255,   246,  11]
    M203=[         4,   246,   255,   254,   245,  11]
    M204=[         4,   245,   254,   253,   244,  11]
    M205=[         4,   244,   253,   252,   243,  11]
    M206=[         4,   243,   252,   251,   242,  11]
    M207=[         4,   242,   251,   250,   241,  11]
    M208=[         4,   241,   250,   249,   240,  11]
    M209=[         4,   239,   248,   247,   238,  11]
    M210=[         4,   238,   247,   246,   237,  11]
    M211=[         4,   237,   246,   245,   236,  11]
    M212=[         4,   236,   245,   244,   235,  11]
    M213=[         4,   235,   244,   243,   234,  11]
    M214=[         4,   234,   243,   242,   233,  11]
    M215=[         4,   233,   242,   241,   232,  11]
    M216=[         4,   232,   241,   240,   231,  11]
    M217=[         4,   230,   239,   238,   229,  11]
    M218=[         4,   229,   238,   237,   228,  11]
    M219=[         4,   228,   237,   236,   227,  11]
    M220=[         4,   227,   236,   235,   226,  11]
    M221=[         4,   226,   235,   234,   225,  11]
    M222=[         4,   225,   234,   233,   224,  11]
    M223=[         4,   224,   233,   232,   223,  11]
    M224=[         4,   223,   232,   231,   222,  11]
    
    Surf_M1_INT = M193     + \
             M194     + \
             M195     + \
             M196     + \
             M197     + \
             M198     + \
             M199     + \
             M200     + \
             M201     + \
             M202     + \
             M203     + \
             M204     + \
             M205     + \
             M206     + \
             M207     + \
             M208     + \
             M209     + \
             M210     + \
             M211     + \
             M212     + \
             M213     + \
             M214     + \
             M215     + \
             M216     + \
             M217     + \
             M218     + \
             M219     + \
             M220     + \
             M221     + \
             M222     + \
             M223     + \
             M224
                        
    bulk = BULK_MATERIAL (solfec,
                          model = 'KIRCHHOFF',
                          young = 2.E+11,
                          poisson = 0.3,
                          density = 7.820E+03)
                                            
    Msh_M1 = MESH(Nodes_M1,Mesh_M1,Surf_M1_INT)
    
    Msh_M2 = MESH(Nodes_M1,Mesh_M1,1)
    
    Mesh_final = Msh_M1
    
    Node=[]
    for i in Mesh_final.nodes_on_surface(11):
      Node.append(Mesh_final.node(i))
      
    Point_A=Mesh_final.node(222)
    
    No_Trait=[]  
    No_Trait.append(Mesh_final.node(223))
    No_Trait.append(Mesh_final.node(224))
    No_Trait.append(Mesh_final.node(225))
    No_Trait.append(Mesh_final.node(226))
    No_Trait.append(Mesh_final.node(227))
    No_Trait.append(Mesh_final.node(228))                    
    No_Trait.append(Mesh_final.node(229))
    No_Trait.append(Mesh_final.node(230))
    No_Trait.append(Mesh_final.node(231))
    No_Trait.append(Mesh_final.node(232))
    No_Trait.append(Mesh_final.node(233))
    No_Trait.append(Mesh_final.node(234))
    No_Trait.append(Mesh_final.node(235))
    No_Trait.append(Mesh_final.node(236))
    No_Trait.append(Mesh_final.node(237))
    No_Trait.append(Mesh_final.node(238))
    No_Trait.append(Mesh_final.node(239))
    No_Trait.append(Mesh_final.node(240))
    No_Trait.append(Mesh_final.node(241))
    No_Trait.append(Mesh_final.node(242))
    No_Trait.append(Mesh_final.node(243))
    No_Trait.append(Mesh_final.node(244))
    No_Trait.append(Mesh_final.node(245))                    
    No_Trait.append(Mesh_final.node(246))
    No_Trait.append(Mesh_final.node(247))
    No_Trait.append(Mesh_final.node(248))
    No_Trait.append(Mesh_final.node(249))
    No_Trait.append(Mesh_final.node(250))
    No_Trait.append(Mesh_final.node(251))
    No_Trait.append(Mesh_final.node(252))
    No_Trait.append(Mesh_final.node(253))
    No_Trait.append(Mesh_final.node(254))
    No_Trait.append(Mesh_final.node(255))
    No_Trait.append(Mesh_final.node(256))
    No_Trait.append(Mesh_final.node(257))
    No_Trait.append(Mesh_final.node(258))
        
    
    
    FIX_XY=[]  
    FIX_XY.append(Mesh_final.node(73))
    FIX_XY.append(Mesh_final.node(110))
    FIX_XY.append(Mesh_final.node(147))
    FIX_XY.append(Mesh_final.node(184))
    FIX_XY.append(Mesh_final.node(221))
    FIX_XY.append(Mesh_final.node(258))
    
    FIX_XYZ=[]  
    FIX_XYZ.append(Mesh_final.node(36))
    
    FIX_YZ=[]  
    FIX_YZ.append(Mesh_final.node(0))
    FIX_YZ.append(Mesh_final.node(8))
    FIX_YZ.append(Mesh_final.node(9))
    FIX_YZ.append(Mesh_final.node(17))
    FIX_YZ.append(Mesh_final.node(18))        
    FIX_YZ.append(Mesh_final.node(26))  
    FIX_YZ.append(Mesh_final.node(27))  
    FIX_YZ.append(Mesh_final.node(35))    
    
    FIX_Y=[]  
    FIX_Y.append(Mesh_final.node(37))
    FIX_Y.append(Mesh_final.node(45))
    FIX_Y.append(Mesh_final.node(46))
    FIX_Y.append(Mesh_final.node(54))
    FIX_Y.append(Mesh_final.node(55))
    FIX_Y.append(Mesh_final.node(63))
    FIX_Y.append(Mesh_final.node(64))
    FIX_Y.append(Mesh_final.node(72))
    FIX_Y.append(Mesh_final.node(74))    
    FIX_Y.append(Mesh_final.node(82))
    FIX_Y.append(Mesh_final.node(83))    
    FIX_Y.append(Mesh_final.node(91))
    FIX_Y.append(Mesh_final.node(92))
    FIX_Y.append(Mesh_final.node(100))
    FIX_Y.append(Mesh_final.node(101))
    FIX_Y.append(Mesh_final.node(109))
    FIX_Y.append(Mesh_final.node(111))    
    FIX_Y.append(Mesh_final.node(119))
    FIX_Y.append(Mesh_final.node(120))    
    FIX_Y.append(Mesh_final.node(128))
    FIX_Y.append(Mesh_final.node(129))    
    FIX_Y.append(Mesh_final.node(137))
    FIX_Y.append(Mesh_final.node(138))
    FIX_Y.append(Mesh_final.node(146))
    FIX_Y.append(Mesh_final.node(148))  
    FIX_Y.append(Mesh_final.node(156))
    FIX_Y.append(Mesh_final.node(157))   
    FIX_Y.append(Mesh_final.node(165))
    FIX_Y.append(Mesh_final.node(166))
    FIX_Y.append(Mesh_final.node(174))
    FIX_Y.append(Mesh_final.node(175))
    FIX_Y.append(Mesh_final.node(183))
    FIX_Y.append(Mesh_final.node(185))   
    FIX_Y.append(Mesh_final.node(193))    
    FIX_Y.append(Mesh_final.node(194))   
    FIX_Y.append(Mesh_final.node(202))
    FIX_Y.append(Mesh_final.node(203))   
    FIX_Y.append(Mesh_final.node(211))
    FIX_Y.append(Mesh_final.node(212))
    FIX_Y.append(Mesh_final.node(220))
    FIX_Y.append(Mesh_final.node(222))
    FIX_Y.append(Mesh_final.node(230))    
    FIX_Y.append(Mesh_final.node(231))   
    FIX_Y.append(Mesh_final.node(239))    
    FIX_Y.append(Mesh_final.node(240))   
    FIX_Y.append(Mesh_final.node(248))
    FIX_Y.append(Mesh_final.node(249))   
    FIX_Y.append(Mesh_final.node(257))
	
    FIX_Z=[]  
    FIX_Z.append(Mesh_final.node(1))
    FIX_Z.append(Mesh_final.node(2))
    FIX_Z.append(Mesh_final.node(3))
    FIX_Z.append(Mesh_final.node(4))
    FIX_Z.append(Mesh_final.node(5))
    FIX_Z.append(Mesh_final.node(6))
    FIX_Z.append(Mesh_final.node(7))
    FIX_Z.append(Mesh_final.node(10))
    FIX_Z.append(Mesh_final.node(11))
    FIX_Z.append(Mesh_final.node(12))
    FIX_Z.append(Mesh_final.node(13))
    FIX_Z.append(Mesh_final.node(14))
    FIX_Z.append(Mesh_final.node(15))    
    FIX_Z.append(Mesh_final.node(16))        
    FIX_Z.append(Mesh_final.node(19))
    FIX_Z.append(Mesh_final.node(20))
    FIX_Z.append(Mesh_final.node(21))
    FIX_Z.append(Mesh_final.node(22))
    FIX_Z.append(Mesh_final.node(23))
    FIX_Z.append(Mesh_final.node(24))    
    FIX_Z.append(Mesh_final.node(25))    
    FIX_Z.append(Mesh_final.node(28))
    FIX_Z.append(Mesh_final.node(29))
    FIX_Z.append(Mesh_final.node(30))
    FIX_Z.append(Mesh_final.node(31))
    FIX_Z.append(Mesh_final.node(32))
    FIX_Z.append(Mesh_final.node(33))    
    FIX_Z.append(Mesh_final.node(34))   
    
    
    Bod_M1 = BODY (solfec, 'FINITE_ELEMENT',Mesh_final,bulk)
    
    data =[]
    time=[]
    vite=[]
    st=step
    n=int(stop/step)*2 #stop/step
    for i in range (1, n):
      x=i*st
      time.append(x)
      y=1E-20
      vite.append(y)  
      
    for (tt,vv) in zip (time,vite):
    	data += [tt,vv]
       
    Serie = TIME_SERIES (data)
    
    for i in range (0,len(Node)):
      DISPLAY_POINT (Bod_M1, Node[i], 'N%d'%i) # press 'D' in the viewer to see display points
    
    Fix_direc_X=(1.,0.,0.)
    Fix_direc_Y=(0.,1.,0.)
    Fix_direc_Z=(0.,0.,1.)    
	    
    for fix in FIX_XY:
      FIX_DIRECTION (Bod_M1, fix, Fix_direc_X)
      FIX_DIRECTION (Bod_M1, fix, Fix_direc_Y)
           
    for fix in FIX_XYZ:
      FIX_POINT(Bod_M1, fix)

    for fix in FIX_YZ:
      FIX_DIRECTION (Bod_M1, fix, Fix_direc_Y)
      FIX_DIRECTION (Bod_M1, fix, Fix_direc_Z)

    for fix in FIX_Y:
      FIX_DIRECTION (Bod_M1, fix, Fix_direc_Y)

    for fix in FIX_Z:
      FIX_DIRECTION (Bod_M1, fix, Fix_direc_Z)      
             
    P=1.0E+08  #N/m2
    surface=11
    PRESSURE (Bod_M1, surface, -P)

    nt = NEWTON_SOLVER (1E-13, delta = 1E-8, locdyn = 'OFF')
    OUTPUT(solfec, outstep)
    if not VIEWER() and solfec.mode == 'WRITE':
      solfec.verbose = '%'
    RUN (solfec, nt, stop)
    return solfec

# data
step = 5E-3
stop = 0.05
outstep = 0.01

# calculate
solfec = create_simulation (step, stop, outstep)

# read results
if not VIEWER():
  solfec = create_simulation (step, stop, outstep)
  if solfec.mode != 'READ':
    print 'READ ERROR'
    import sys
    sys.exit(1)

  body = solfec.bodies[0]
  mesh0 = COPY(body.mesh)

  data_dz = [
#       1-based          current           DZ            DZ    
#       node           node coords    Solfec 841200b  Code_Aster
        (238, (0.2308, 0.6500, 3.0000), -1.467E-03, -1.466E-03),
        (245, (0.2973, 0.3106, 3.0000), -1.465E-03, -1.464E-03),
	(229, (0.3265, 0.8809, 3.0000), -1.478E-03, -1.477E-03),
	(244, (0.3595, 0.2348, 3.0000), -1.468E-03, -1.467E-03),
	(237, (0.3605, 0.5807, 3.0000), -1.473E-03, -1.472E-03),
	(243, (0.4057, 0.1484, 3.0000), -1.470E-03, -1.469E-03),
	(242, (0.4342, 0.0546, 3.0000), -1.471E-03, -1.470E-03),
        (241, (0.4438, -0.0429, 3.0000), -1.472E-03, -1.471E-03),
	(236, (0.4741, 0.4874, 3.0000), -1.478E-03, -1.477E-03),
	(228, (0.4994, 0.7885, 3.0000), -1.484E-03, -1.483E-03),
	(235, (0.5674, 0.3737, 3.0000), -1.481E-03, -1.480E-03),
	(234, (0.6367, 0.2441, 3.0000), -1.483E-03, -1.482E-03),
	(227, (0.6509, 0.6642, 3.0000), -1.489E-03, -1.487E-03),
	(233, (0.6794, 0.1034, 3.0000), -1.484E-03, -1.483E-03),
        (232, (0.6938, -0.0429, 3.0000), -1.484E-03, -1.483E-03)]

  failed = False
  SEEK (solfec, stop)
  for item in data_dz:
    pnt = mesh0.node(item[0]-1)
    disp = DISPLACEMENT (body, pnt)
    Value = disp[2]
    Code_Aster_Ref = item[3]
    error = abs(Value-Code_Aster_Ref)/abs(Code_Aster_Ref) 
    tolerance = 0.0011

    if error > tolerance:
      failed = True
      print '\b\b\b\bFAILED', 
      print '(Computed displacement at node %d was %g' % (item[0]-1, Value), 'while reference is %g)' % Code_Aster_Ref,
      print '-->(error %g, while tolerance %g)' % (error, tolerance)

  if not failed: print '\b\b\b\bPASSED'
